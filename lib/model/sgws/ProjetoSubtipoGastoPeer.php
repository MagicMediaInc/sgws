<?php


/**
 * Skeleton subclass for performing query and update operations on the 'projeto_subtipo_gasto' table.
 *
 * 
 *
 * This class was autogenerated by Propel 1.4.1 on:
 *
 * 13/02/2014 10:38:00
 *
 * You should add additional methods to this class to meet the
 * application requirements.  This class will only be generated as
 * long as it does not already exist in the output directory.
 *
 * @package    lib.model.sgws
 */
class ProjetoSubtipoGastoPeer extends BaseProjetoSubtipoGastoPeer {
    
    public static function deleteAllSubtipoProjeto($id)
    {
        $c = new Criteria();
        $c->add(self::ID_PROJETO, $id, Criteria::EQUAL);
        return self::doDelete($c);
    }
    
    public static function getValorProjetoSubtipo($id_projeto, $idSubtipo)
    {
        $c = new Criteria();
        $c->add(self::ID_PROJETO, $id_projeto, Criteria::EQUAL);
        $c->add(self::ID_SUBTIPO, $idSubtipo, Criteria::EQUAL);
        return self::doSelectOne($c);
    }
    
    public static function getValoresProjeto($id_projeto)
    {
        $c = new Criteria();
        $c->add(self::ID_PROJETO, $id_projeto, Criteria::EQUAL);
        return self::doSelect($c);
    }
    
    public static function getPrevistoDespesa($id) {
        $c =  new Criteria();
        //Eliminamos la columnas de seleccion en caso de que esten definidas
        $c->clearSelectColumns();
        //Selecciona las columnas
        $c->addSelectColumn(self::VALOR);
        //Condicion
        $c->add(self::ID_PROJETO, $id, Criteria::EQUAL);
        $c->add(self::VALOR, 0, Criteria::GREATER_THAN);
        //Ejecucion de consulta
        
        $rs = self::doSelectStmt($c);
        //Se recuperan los registros y se genera arreglo
        $prev = 0;
        while($res = $rs->fetch()) {
            $prev = $prev + $res['VALOR'];
        }
        return $prev;
    }

} // ProjetoSubtipoGastoPeer
